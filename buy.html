<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>三农服务平台 - 智慧农业金融一体化解决方案</title>
    <link rel="stylesheet" href="index.css">
    <!-- 引入 Font Awesome 图标库 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<header class="topbar">
    <div class="brand">
        <i class="fa-solid fa-seedling"></i>
        <span>三农服务平台</span>
    </div>
    <nav class="nav">
        <a href="index.html" class="all">首页</a>
        <a href="loans.html" data-identity="1">融资服务</a>
        <a href="appointment.html" data-identity="1">专家预约</a>
        <a href="buy.html" data-identity="all" class="current">农产品商城</a>
        <a href="knowledge.html" data-identity="all">知识库</a>
        <a href="products.html" data-identity="1">农产品管理</a>
    </nav>
    <div class="user">
        <span id="user-id-display" class="user-id"></span>
        <a href="profile.html" class="btn btn-secondary">
            <i class="fa-regular fa-user" style="margin-right: 6px;"></i>个人中心
        </a>
        <button id="btn-logout" class="btn-secondary" style="border:none; color: rgba(255,255,255,0.7);">退出</button>
    </div>
</header>

<main class="container">
    <section id="agricultural-products" class="card col-span-12" data-identity="all">
        <div class="card-header">
            <h2>农产品商城</h2>
            <p class="subtle">精选农产品，点击卡片查看详情与评论</p>
            <div class="card-actions">
                <button id="btn-refresh-products" class="btn btn-secondary">刷新商品</button>
            </div>
        </div>
        <div class="product-grid" id="product-catalog-list"></div>
        <div class="msg" id="msg-product-catalog"></div>
    </section>

    <div id="product-modal" class="modal-backdrop hidden" role="dialog" aria-modal="true">
        <div class="modal modal-large">
            <button class="modal-close" id="btn-close-product-modal" aria-label="关闭">×</button>
            <div class="product-modal-body">
                <div class="detail-box">
                    <div class="msg" id="modal-product-msg">加载商品详情中...</div>
                    <div id="modal-product-info"></div>
                </div>
            <div class="comment-block" id="product-comment-block">
                <div class="comment-header-line">
                    <h3>评论区</h3>
                    <button type="button" class="btn btn-outline" id="btn-toggle-comments">收起评论</button>
                </div>
                <div class="comment-input-box">
                    <textarea id="comment-content-input" rows="3" placeholder="分享你的看法..." disabled></textarea>
                    <div class="comment-input-actions">
                        <span class="reply-tip hidden" id="replying-to">
                            回复 <strong id="reply-target-name"></strong>
                            <button type="button" class="link-btn" id="btn-cancel-reply">取消</button>
                        </span>
                        <button type="button" class="btn" id="btn-submit-comment" disabled>发布评论</button>
                    </div>
                    <div class="msg" id="msg-comment"></div>
                </div>
                <div class="msg" id="modal-comment-msg"></div>
                <div class="comment-list" id="modal-comment-list"></div>
            </div>
            </div>
            <div class="product-modal-actions">
                <div class="modal-selected-name" id="modal-selected-name"></div>
                <div class="modal-action-controls">
                    <label for="product-modal-cart-amount">数量</label>
                    <div class="stepper">
                        <button type="button" id="btn-cart-amount-dec" aria-label="减少数量">−</button>
                        <input type="number" id="product-modal-cart-amount" min="1" value="1">
                        <button type="button" id="btn-cart-amount-inc" aria-label="增加数量">＋</button>
                    </div>
                    <div class="price-summary">
                        <span>单价：<strong id="modal-unit-price">—</strong></span>
                        <span>合计：<strong id="modal-total-price">—</strong></span>
                    </div>
                </div>
                <div class="modal-action-buttons">
                    <button type="button" class="btn" id="btn-modal-add-cart">加入购物车</button>
                    <button type="button" class="btn" id="btn-modal-purchase">直接购买</button>
                </div>
            </div>
        </div>
    </div>

    <div id="purchase-modal" class="modal-backdrop hidden" role="dialog" aria-modal="true">
        <div class="modal">
            <h3 id="purchase-modal-title">填写信息</h3>
            <p class="subtle" id="purchase-modal-product-name"></p>
            <form id="form-purchase-modal">
                <div class="row" id="purchase-modal-amount-row">
                    <label for="purchase-modal-amount">购买数量</label>
                    <input type="number" id="purchase-modal-amount" min="1" value="1" required>
                </div>
                <div class="row" id="purchase-modal-address-group">
                    <label for="purchase-modal-address">收货地址</label>
                    <div class="address-field">
                        <div class="address-select-stack">
                            <select id="purchase-modal-address-select">
                                <option value="">选择保存的地址</option>
                            </select>
                            <button type="button" class="btn btn-secondary" id="btn-refresh-address">刷新</button>
                        </div>
                        <input type="text" id="purchase-modal-address" placeholder="请选择或输入详细地址">
                    </div>
                </div>
                <div class="msg" id="msg-purchase-modal"></div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="btn-purchase-cancel">取消</button>
                    <button type="submit" class="btn">确认提交</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 购物车展示 -->
    <section id="buyer-cart" class="card col-span-6" data-identity="all">
        <div class="card-header">
            <h2>我的购物车</h2>
            <p class="subtle">可从购物车直接结算或删除商品</p>
            <div class="card-actions">
                <button id="btn-refresh-cart" class="btn btn-secondary">刷新购物车</button>
            </div>
        </div>
        <div class="list" id="cart-display-list"></div>
        <div class="msg" id="msg-cart-display"></div>
    </section>

    <!-- 购买记录展示 -->
    <section id="buyer-orders" class="card col-span-6" data-identity="all">
        <div class="card-header">
            <h2>我的购买记录</h2>
            <p class="subtle">查看订单状态并执行收货、取消或退货</p>
            <div class="card-actions">
                <button id="btn-refresh-orders" class="btn btn-secondary">刷新购买记录</button>
            </div>
        </div>
        <div class="list" id="orders-display-list"></div>
        <div class="msg" id="msg-orders-display"></div>
    </section>

</main>

<script src="index.js"></script>
<!-- <script src="appointment.js"></script> -->
</body>
</html>
